<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <title>studysdata</title>
    <link rel="stylesheet" href="../layui/css/layui.css" media="all">
    <style>
        body {
            margin: 10px;
        }
        
        .demo-carousel {
            height: 200px;
            line-height: 200px;
            text-align: center;
        }
    </style>
</head>

<body>
    <!-- js src~~ -->
    <script src="../layui/layui.js"></script>

    <script>
        layui.use('laydate', function() {
            var laydate = layui.laydate; //执行一个laydate实例
            laydate.render({
                elem: '#stduystart', //指定元素
                calendar: true
            });
            laydate.render({
                elem: '#stduyend', //指定元素
                calendar: true
            });
            laydate.render({
                elem: '#birthdate', //指定元素
                calendar: true
            });
            laydate.render({
                elem: '#ScheduledDate', //指定元素
                calendar: true
            });
        });
    </script>
    <div class="layui-tab layui-tab-brief" lay-filter="TabBrief">
        <ul class="layui-tab-title">
            <li class="layui-this">Patients</li>
            <li>Add/Edit</li>
            <li>Tool</li>
            <li>Updown</li>
        </ul>
        <div class="layui-tab-content">
            <div class="layui-tab-item layui-show">
                <!-- patients datas table start -->
                <table class="layui-hide" id="studytable" lay-filter="studytabledatas"></table>
                <div class="layui-inline">
                    StduyDateFrom:
                </div>
                <div class="layui-inline">
                    <input type="text" class="layui-input" id="stduystart" placeholder="yyyyMMdd">
                </div>
                <div class="layui-inline">
                    StduyDateEnd:
                </div>
                <div class="layui-inline">
                    <input type="text" class="layui-input" id="stduyend" placeholder="yyyyMMdd">
                </div>
                <!-- end patients datas table  -->
            </div>
            <!-- $$$$$$$$$$$$$$$$$$$$$$$$  form  add / edit patients datas start $$$$$$$$$$$$$$$$$$$$$$$$$$-->
            <div class="layui-tab-item">
                <form class="layui-form layui-form-pane1" action="" lay-filter="first">
                    <div class="layui-form-item">
                        <label class="layui-form-label">PatientName:</label>
                        <div class="layui-input-inline">
                            <input type="text" name="PatientName" lay-verify="required|title" lay-reqText="PatientName不能为空" required placeholder="name" autocomplete="off" class="layui-input">
                        </div>
                        <!--<label class="layui-form-label">PatientSex:</label>
                         <div class="layui-input-block">
                            <input type="radio" name="sex" value="男" title="男" checked>
                            <input type="radio" name="sex" value="女" title="女">
                            <input type="radio" name="sex" value="其他" title="其他" disabled>
                        </div> -->
                    </div>
                    <div class="layui-form-item" pane>
                        <label class="layui-form-label">PatientSex:</label>
                        <div class="layui-input-block">
                            <input type="radio" name="PatientSex" value="男" title="男" checked>
                            <input type="radio" name="PatientSex" value="女" title="女">
                            <input type="radio" name="PatientSex" value="其他" title="其他" disabled>
                        </div>
                    </div>
                    <div class="layui-form-item">
                        <label class="layui-form-label">PatientBirth:</label>
                        <div class="layui-input-inline">
                            <input type="text" name="PatientBirthday" id="birthdate" lay-verify="date" placeholder="yyyyMMdd" autocomplete="off" class="layui-input">
                        </div>
                    </div>
                    <div class="layui-form-item">
                        <label class="layui-form-label">phone:</label>
                        <div class="layui-input-inline">
                            <input type="tel" name="phone" lay-verify="required|number" lay-verType="tips" autocomplete="off" class="layui-input">
                        </div>
                    </div>
                    <div class="layui-form-item">
                        <label class="layui-form-label">Email:</label>
                        <div class="layui-input-inline">
                            <input type="email" name="email" lay-verify="email" lay-verType="alert" autocomplete="off" class="layui-input">
                        </div>
                    </div>
                    <div class="layui-form-item">
                        <label class="layui-form-label">PatientCarID:</label>
                        <div class="layui-input-inline">
                            <input type="text" name="PatientCarID" lay-verify="required|title" lay-reqText="PatientCarID标题不能为空" required placeholder="CarID" autocomplete="off" class="layui-input">
                        </div>
                    </div>
                    <div class="layui-form-item">
                        <label class="layui-form-label">PatientAddr:</label>
                        <div class="layui-input-block">
                            <input type="text" name="PatientAddr" lay-verify="required|title" lay-reqText="PatientAddr不能为空" required placeholder="PatientAddr" autocomplete="off" class="layui-input">
                        </div>
                    </div>
                    <div class="layui-form-item">
                        <div class="layui-inline">
                            <label class="layui-form-label">Cost:</label>
                            <div class="layui-input-inline" style="width: 100px;">
                                <input type="text" name="Cost" placeholder="￥" autocomplete="off" class="layui-input">
                            </div>
                        </div>
                        <div class="layui-inline">
                            <label class="layui-form-label">StudyContent:</label>
                            <div class="layui-input-block">
                                <select name="StudyContent" lay-filter="quiz">
                                        <option value="">SelectDepartments </option>
                                        <optgroup label="RIS">
                                          <option value="10">普放科</option>
                                          <option value="11">核医学</option>
                                        </optgroup>
                                        <optgroup label="US">
                                          <option value="20">心脏科</option>
                                          <option value="21">彩超科</option>
                                        </optgroup>
                                        <optgroup label="ES">
                                        <option value="30">肠镜科</option>
                                        <option value="31">胃镜科</option>
                                        </optgroup>
                                      </select>
                            </div>
                        </div>
                        <div class="layui-inline">
                            <label class="layui-form-label">StudyModality:</label>
                            <div class="layui-input-block">
                                <select name="StudyModality" lay-verify="required" lay-verType="tips">
                                    <option value="">Select study modality</option>
                                    <option value="0">CT</option>
                                    <option value="1">MR</option>
                                    <option value="2">DR</option>
                                    <option value="3">CR</option>
                                    <option value="4">RF</option>
                                    <option value="5">DX</option>
                                    <option value="6">PET</option>
                                    <option value="6">US</option>
                                    <option value="7">ES</option>
                                  </select>
                            </div>
                        </div>

                    </div>
                    <div class="layui-form-item">
                        <label class="layui-form-label">ScheduledDate:</label>
                        <div class="layui-input-inline">
                            <input type="text" name="ScheduledDate" id="ScheduledDate" lay-verify="date" placeholder="yyyyMMdd" autocomplete="off" class="layui-input">
                        </div>
                    </div>
                    <div class="layui-form-item">
                        <label class="layui-form-label">CostType</label>
                        <div class="layui-input-inline">
                            <select name="CostType" lay-filter="interest">
                                  <option value=""></option>
                                  <option value="0">自费</option>
                                  <option value="1">公费</option>
                                  <option value="2">半公费</option>
                                  <option value="3">其它</option>
                                </select>
                        </div>
                    </div>
                    <div class="layui-form-item layui-form-text">
                        <label class="layui-form-label">请填写检查描述</label>
                        <div class="layui-input-block">
                            <textarea placeholder="检查描述" class="layui-textarea" name="StudyDescription"></textarea>
                        </div>
                    </div>
                    <div class="layui-form-item">
                        <div class="layui-input-block">
                            <button class="layui-btn" lay-submit lay-filter="*">立即提交</button>
                            <button type="reset" class="layui-btn layui-btn-primary">重置</button>
                        </div>
                    </div>
                </form>
            </div>
            <!-- $$$$$$$$$$$$$$$$$$$$$$$$$$$$$ end form $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$----- -->
            <div class="layui-tab-item ">Tools</div>
            <div class="layui-tab-item ">
                upload file to server
                <div class="layui-inline ">
                    <input type="text " class="layui-input " id="uploadDemo ">
                </div>
            </div>
        </div>
        <div class="layui-tab-content "></div>
    </div>

    <script type="text/html " id="barDemo ">
        <a class="layui-btn layui-btn-primary layui-btn-xs " lay-event="detail ">查看</a>
        <a class="layui-btn layui-btn-xs " lay-event="edit ">编辑</a>
        <a class="layui-btn layui-btn-danger layui-btn-xs " lay-event="del ">删除</a>
    </script>

    <script>
        layui.use(['laypage', 'table', 'element', 'upload'], function() {
            var laypage = layui.laypage, //分页
                table = layui.table, //表格
                element = layui.element, //元素操作
                upload = layui.upload; //上传
            layer.msg('show patients study datas');

            //监听Tab切换
            element.on('tab(TabBrief)', function(data) {
                layer.tips('切换了 ' + data.index + '：' + this.innerHTML, this, {
                    tips: 1
                });
            });
            // var myDate = new Date();
            // var mytime = myDate.toLocaleTimeString();
            // layer.msg('mytime:' + mytime);
            //执行一个 table 实例
            table.render({
                elem: '#studytable',
                height: 650,
                url: window.location.host + '/healthsystem/ris/stduydata/?start=20190101&end=20191219', //数据接口 http://127.0.0.1:80/
                //url: 'http://127.0.0.1/healthsystem/ris/stduydata/?start=20190101&end=20191219',
                title: 'patients',
                page: true, //开启分页
                toolbar: 'default', //开启工具栏，此处显示默认图标，可以自定义模板，详见文档
                totalRow: true, //开启合计行
                loading: true,
                //skin: 'row' ,
                limits: [20, 40, 60, 80, 100],
                limit: 20,
                cols: [
                    [ //表头
                        {
                            type: 'checkbox',
                            fixed: 'left'
                        }, {
                            field: 'patientId',
                            title: 'patientId',
                            width: 100,
                            sort: true,
                            fixed: 'left',
                            totalRowText: '合计：'
                        }, {
                            field: 'patientName',
                            width: 120,
                            title: 'patientName'
                        }, {
                            field: 'studyDate',
                            title: 'studyDate',
                            sort: true,
                            totalRow: false
                        }, {
                            field: 'patientSex',
                            title: 'patientSex',
                            width: 100,
                            sort: false
                        }, {
                            field: 'modality',
                            title: 'modality',
                            width: 100
                        }, {
                            field: 'studyId',
                            title: 'studyId',
                            width: 120,
                            sort: true,
                            totalRow: true
                        }, {
                            field: 'patientBirthday',
                            title: 'patientBirthday',
                            sort: true
                        }, {
                            field: 'studyDescription',
                            title: 'studyDescription'
                        }, {
                            field: 'scheduledDateTime',
                            title: 'scheduledDateTime',
                            sort: true,
                            totalRow: true
                        }, {
                            fixed: 'right',
                            align: 'center',
                            toolbar: '#barDemo'
                        }
                    ]
                ]
            });

            //监听头工具栏事件
            table.on('toolbar(studytabledatas)', function(obj) {
                var checkStatus = table.checkStatus(obj.config.id),
                    data = checkStatus.data; //获取选中的数据
                switch (obj.event) {
                    case 'add':
                        {
                            //layer.msg('--添加---');
                            layer.open({
                                area: ['500px', '300px'],
                                type: 2,
                                content: ['https://cn.bing.com', 'no']
                            });
                            break;
                        }
                    case 'update':
                        if (data.length === 0) {
                            layer.msg('请选择一行');
                        } else if (data.length > 1) {
                            layer.msg('只能同时编辑一个');
                        } else {
                            layer.alert('编辑 [id]：' + checkStatus.data[0].id);
                        }
                        break;
                    case 'delete':
                        if (data.length === 0) {
                            layer.msg('请选择一行');
                        } else {
                            layer.msg('删除');
                        }
                        break;
                };
            });

            //监听行工具事件 
            table.on('tool(studytabledatas)', function(obj) {
                var data = obj.data, //获得当前行数据
                    layEvent = obj.event; //获得 lay-event 对应的值
                if (layEvent === 'detail') {
                    //layer.msg('查看操作');
                    layer.alert('detail： rowIndex:' + obj.tr[0].rowIndex + ' 选中数据:' + JSON.stringify(obj.data));
                } else if (layEvent === 'del') {
                    layer.confirm('真的删除行么', function(index) {
                        obj.del(); //删除对应行（tr）的DOM结构
                        layer.close(index);
                        //向服务端发送删除指令
                    });
                } else if (layEvent === 'edit') {
                    layer.msg('编辑操作');
                }
            });
            //监听表格行点击
            // table.on('row(studytabledatas)', function(obj){
            //     console.log(obj)
            //     layer.alert('row rowIndex:'+ obj.tr[0].rowIndex +' 选中数据:'+JSON.stringify(obj.data));
            //  });
            //监听表格行双击
            table.on('rowDouble(studytabledatas)', function(obj) {
                console.log(obj)
                layer.alert('rowDouble rowIndex:' + obj.tr[0].rowIndex + ' 选中数据:' + JSON.stringify(obj.data));
            });
            //上传
            upload.render({
                elem: '#uploadDemo',
                url: '' //上传接口
                    ,
                done: function(res) {
                    console.log(res)
                }
            });
        });
    </script>
</body>

</html>